<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        .calculator {
            box-shadow: 0 10px 30px rgba(249, 180, 180, 0.1);
            transition: all 0.3s ease;
        }
        .calculator:hover {
            box-shadow: 0 15px 35px rgba(249, 149, 149, 0.15);
        }
        .btn {
            transition: all 0.2s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn:active {
            transform: translateY(0);
        }
        .operator-btn {
            background-color: #3b82f6;
            color: rgb(255, 253, 253);
        }
        .operator-btn:hover {
            background-color: #7896d6;
        }
        .equals-btn {
            background-color: #7fceb3;
            color: white;
        }
        .equals-btn:hover {
            background-color: #059669;
        }
        .clear-btn {
            background-color: #db4646;
            color: white;
        }
        .clear-btn:hover {
            background-color: #dc2626;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="calculator bg-white rounded-2xl p-6 w-full max-w-md">
        <!-- Display -->
        <div class="display bg-gray-50 rounded-xl p-4 mb-6 h-24 flex flex-col justify-end items-end">
            <div id="previous-operand" class="text-gray-500 text-lg h-6"></div>
            <div id="current-operand" class="text-3xl font-semibold truncate w-full text-right"></div>
        </div>

        <!-- Buttons -->
        <div class="grid grid-cols-4 gap-3">
            <!-- Row 1 -->
            <button class="clear-btn btn col-span-2 py-4 rounded-xl font-medium text-lg">AC</button>
            <button class="operator-btn btn py-4 rounded-xl font-medium text-lg" data-operation="÷">÷</button>
            <button class="operator-btn btn py-4 rounded-xl font-medium text-lg" data-operation="×">×</button>
            
            <!-- Row 2 -->
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="7">7</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="8">8</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="9">9</button>
            <button class="operator-btn btn py-4 rounded-xl font-medium text-lg" data-operation="-">-</button>
            
            <!-- Row 3 -->
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="4">4</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="5">5</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="6">6</button>
            <button class="operator-btn btn py-4 rounded-xl font-medium text-lg" data-operation="+">+</button>
            
            <!-- Row 4 -->
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="1">1</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="2">2</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number="3">3</button>
            <button class="equals-btn btn py-4 rounded-xl font-medium text-lg" data-equals>=</button>
            
            <!-- Row 5 -->
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg col-span-2" data-number="0">0</button>
            <button class="number-btn btn bg-gray-100 py-4 rounded-xl font-medium text-lg" data-number=".">.</button>
            <button class="operator-btn btn py-4 rounded-xl font-medium text-lg" data-operation="%">%</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const previousOperandElement = document.getElementById('previous-operand');
            const currentOperandElement = document.getElementById('current-operand');
            const numberButtons = document.querySelectorAll('[data-number]');
            const operationButtons = document.querySelectorAll('[data-operation]');
            const equalsButton = document.querySelector('[data-equals]');
            const clearButton = document.querySelector('.clear-btn');

            let currentOperand = '';
            let previousOperand = '';
            let operation = undefined;
            let shouldResetScreen = false;

            // Helper functions
            const appendNumber = (number) => {
                if (number === '.' && currentOperand.includes('.')) return;
                if (currentOperand === '0' && number !== '.') {
                    currentOperand = number;
                } else {
                    currentOperand += number;
                }
            };

            const chooseOperation = (selectedOperation) => {
                if (currentOperand === '') return;
                if (previousOperand !== '') {
                    compute();
                }
                operation = selectedOperation;
                previousOperand = currentOperand;
                currentOperand = '';
            };

            const compute = () => {
                let computation;
                const prev = parseFloat(previousOperand);
                const current = parseFloat(currentOperand);
                if (isNaN(prev) || isNaN(current)) return;

                switch (operation) {
                    case '+':
                        computation = prev + current;
                        break;
                    case '-':
                        computation = prev - current;
                        break;
                    case '×':
                        computation = prev * current;
                        break;
                    case '÷':
                        computation = prev / current;
                        break;
                    case '%':
                        computation = prev % current;
                        break;
                    default:
                        return;
                }

                currentOperand = computation.toString();
                operation = undefined;
                previousOperand = '';
                shouldResetScreen = true;
            };

            const clear = () => {
                currentOperand = '';
                previousOperand = '';
                operation = undefined;
            };

            const updateDisplay = () => {
                currentOperandElement.innerText = currentOperand;
                if (operation != null) {
                    previousOperandElement.innerText = `${previousOperand} ${operation}`;
                } else {
                    previousOperandElement.innerText = previousOperand;
                }
            };

            // Event listeners
            numberButtons.forEach(button => {
                button.addEventListener('click', () => {
                    if (currentOperandElement.innerText === '0' || shouldResetScreen) {
                        currentOperand = '';
                        shouldResetScreen = false;
                    }
                    appendNumber(button.innerText);
                    updateDisplay();
                });
            });

            operationButtons.forEach(button => {
                button.addEventListener('click', () => {
                    chooseOperation(button.innerText);
                    updateDisplay();
                });
            });

            equalsButton.addEventListener('click', () => {
                compute();
                updateDisplay();
            });

            clearButton.addEventListener('click', () => {
                clear();
                updateDisplay();
            });

            // Keyboard support
            document.addEventListener('keydown', (e) => {
                if (e.key >= 0 && e.key <= 9) {
                    appendNumber(e.key);
                    updateDisplay();
                } else if (e.key === '.') {
                    appendNumber(e.key);
                    updateDisplay();
                } else if (e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/' || e.key === '%') {
                    chooseOperation(e.key === '*' ? '×' : e.key === '/' ? '÷' : e.key);
                    updateDisplay();
                } else if (e.key === 'Enter' || e.key === '=') {
                    compute();
                    updateDisplay();
                } else if (e.key === 'Escape') {
                    clear();
                    updateDisplay();
                } else if (e.key === 'Backspace') {
                    currentOperand = currentOperand.slice(0, -1);
                    if (currentOperand === '') currentOperand = '0';
                    updateDisplay();
                }
            });
        });
    </script>
</body>
</html>